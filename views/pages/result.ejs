<!DOCTYPE html>
<html lang="fr" class="h-full">
<head>
    <%- include('../partials/head'); %>
    <meta property="og:title" content="<%= resultMessage %>" />
    <meta property="og:description" content="J'ai obtenu un score de <%= score %> en devinant le mot '<%= word %>' dans le jeu du pendu !" />
    <meta property="og:image" content="<%= imageUrl %>" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="<%= baseUrl %>/result?data=<%= data %>" />
    <title>R√©sultat du jeu du pendu</title>
</head>
<body class="h-full bg-gray-300 text-gray-800">
<div class="flex items-center justify-center h-full w-full">
    <div class="game-container flex flex-col h-full w-full sm:h-auto max-h-[852px] max-w-[440px] bg-white sm:shadow-lg sm:rounded-2xl">
        <!-- En-t√™te -->
        <header class="bg-gradient-to-r from-blue-500 to-purple-600 text-white p-6 sm:rounded-t-2xl">
            <h1 class="text-4xl font-bold text-center mb-4"><%= resultMessage %></h1>
        </header>

        <!-- Contenu principal -->
        <main class="flex-grow container mx-auto px-4 py-8">
            <!-- Mot √† deviner -->
            <section class="mb-8">
                <h2 class="text-xl font-semibold text-gray-700 text-center mb-2">Le mot √©tait :</h2>
                <p class="text-3xl font-bold text-center text-blue-600"><%= word %></p>
            </section>

            <!-- Score -->
            <section class="mb-8">
                <% if (!shared) { %>
                    <h2 class="text-xl font-semibold text-gray-700 text-center mb-2">Votre score :</h2>
                <% } else { %>
                    <h2 class="text-xl font-semibold text-gray-700 text-center mb-2">Score :</h2>
                <% } %>
                <p class="text-4xl font-bold text-center text-red-500"><%= score %></p>
            </section>

            <!-- Boutons d'action -->
            <div class="text-center space-y-4">
                <% if (!shared) { %>
                    <!-- Bouton Partager -->
                    <button onclick="shareScore()" class="bg-green-500 text-white py-2 px-4 rounded-lg shadow hover:bg-green-600 transition-colors">
                        Partager mon score
                    </button>
                <% } %>
                <a href="/" onclick="resetGame(event)" class="inline-block bg-blue-500 text-white py-2 px-4 rounded-lg shadow hover:bg-blue-600 transition-colors">
                    <%= shared ? 'Jouer' : 'Rejouer' %>
                </a>
            </div>
        </main>

        <!-- Pied de page -->
        <footer class="bg-gray-800 text-gray-400 text-center py-4 sm:rounded-b-2xl">
            <p class="text-sm">Merci d'avoir jou√© au jeu du pendu !</p>
        </footer>
    </div>
</div>

<script>
    // R√©initialiser le jeu
    function resetGame(event) {
        event.preventDefault();
        fetch('/api/reset', { method: 'POST' })
            .then(() => {
                window.location.href = '/';
            })
            .catch(err => console.error('Erreur lors de la r√©initialisation du jeu :', err));
    }

    // Partager le score
    function shareScore() {
        const encodedData = "<%= data %>";
        const shareUrl = `${window.location.origin}/result?data=${encodedData}&shared=true`;

        if (navigator.share) {
            navigator
                .share({
                    title: 'Mon score au jeu du pendu',
                    text: `J'ai obtenu un score de <%= score %> en devinant le mot "<%= word %>" dans le jeu du pendu ! üéâ`,
                    url: shareUrl,
                })
                .then(() => console.log('Score partag√© avec succ√®s !'))
                .catch(err => console.error('Erreur lors du partage :', err));
        } else {
            alert("Le partage n'est pas pris en charge sur cet appareil ou ce navigateur.");
        }
    }
</script>

<!-- Styles pour la pleine hauteur sur mobile -->
<style>
    @media (max-width: 640px) {
        .game-container {
            height: 100vh;
            max-height: 100vh;
        }
    }
</style>
</body>
</html>
